<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>欢迎圆哥 — 小游戏</title>
<style>
  :root{--bg1:#fff0f6;--bg2:#fff7fb;--accent:#ff4f8b;--text:#333}
  html,body{height:100%;margin:0;font-family:"Microsoft YaHei",sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2))}
  .container{height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:16px;padding:20px;box-sizing:border-box}
  .card{width:100%;max-width:960px;height:640px;border-radius:18px;box-shadow:0 20px 40px rgba(0,0,0,0.12);background:radial-gradient(circle at 10% 10%, rgba(255,255,255,0.9), rgba(255,255,255,0.7));display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
  #welcomeText{position:absolute;top:28px;width:100%;text-align:center;font-size:48px;color:var(--accent);text-shadow:0 6px 18px rgba(255,79,139,0.12)}
  .girl-wrapper{position:relative;height:80%;display:flex;align-items:flex-end;justify-content:center;width:100%}
  .girl{height:90%;max-height:540px;user-select:none;pointer-events:none;transform-origin:50% 95%}
  .wave{animation:wave 1.2s ease-in-out infinite}
  @keyframes wave{0%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-6px) rotate(2deg)}100%{transform:translateY(0) rotate(0deg)}}
  .controls{position:absolute;bottom:18px;left:18px;display:flex;gap:10px;align-items:center}
  .btn{background:linear-gradient(180deg,#fff,#ffeef8);border:1px solid rgba(0,0,0,0.06);padding:10px 14px;border-radius:10px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.06);font-weight:600}
  .small{padding:6px 8px;border-radius:8px;font-size:14px}
  .hearts{position:absolute;right:18px;bottom:18px;display:flex;gap:8px;align-items:center}
  .heart{width:44px;height:44px;border-radius:999px;background:linear-gradient(180deg,#fff,#ffddee);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 20px rgba(255,79,139,0.12);font-size:18px;color:var(--accent);cursor:pointer}
  .overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;backdrop-filter: blur(2px);background:linear-gradient(180deg,rgba(255,255,255,0.0), rgba(255,255,255,0.0));pointer-events:none}
  .tip{position:absolute;top:8px;left:12px;font-size:13px;color:#666}
  input[type=file]{display:none}
  /* responsive */
  @media (max-width:520px){
    #welcomeText{font-size:28px}
    .card{height:520px}
  }
</style>
</head>
<body>
  <div class="container">
    <div class="card" id="card">
      <div id="welcomeText">欢迎 圆哥！</div>
      <div class="girl-wrapper">
        <!-- 默认示例图片，建议替换为你自己的透明美女 PNG，文件名: girl.png -->
        <img id="girl" class="girl wave" src="/Users/swanfu/Desktop/welcome_yuange/girl.png" alt="美女示例">
      </div>

      <div class="controls">
        <label class="btn" id="playBtn">▶ 播放背景音乐</label>
        <label class="btn small" title="上传本地音乐 (mp3)" for="audioFileInput">上传音乐</label>
        <input id="audioFileInput" type="file" accept="audio/*">
        <label class="btn small" id="toggleTextBtn">切换文案</label>
      </div>

      <div class="hearts">
        <div class="heart" id="heartBtn">❤</div>
        <div class="heart" id="confettiBtn">✦</div>
      </div>

      <div class="tip">提示：部分浏览器阻止自动播放，首次点击任意处将允许播放。</div>
      <div class="overlay" id="overlay"></div>
    </div>

    <div style="max-width:960px; width:100%; display:flex; gap:12px; justify-content:center; margin-top:10px;">
      <a class="btn small" id="downloadBtn">下载此页面 (HTML)</a>
      <a class="btn small" id="hostGuide">如何部署到 GitHub Pages</a>
    </div>
  </div>

  <audio id="bgm" loop preload="none"></audio>

<script>
  const bgm = document.getElementById('bgm');
  const playBtn = document.getElementById('playBtn');
  const audioFileInput = document.getElementById('audioFileInput');
  const heartBtn = document.getElementById('heartBtn');
  const confettiBtn = document.getElementById('confettiBtn');
  const overlay = document.getElementById('overlay');
  const card = document.getElementById('card');
  const girl = document.getElementById('girl');
  const downloadBtn = document.getElementById('downloadBtn');
  const hostGuide = document.getElementById('hostGuide');
  const toggleTextBtn = document.getElementById('toggleTextBtn');

  // 默认提示音乐（空），用户需上传或替换文件。你可以替换为你的 "/Users/swanfu/Desktop/welcome_yuange/sun_never_sets.mp3"
  let hasStarted = false;

  // 点击播放或暂停
  playBtn.addEventListener('click', async () => {
    if (!hasStarted) {
      // try autoplay if src set
      try{ await bgm.play(); hasStarted = true; playBtn.textContent = '⏸ 暂停音乐'; }
      catch(e){ 
        // if no src or autoplay blocked
        if(!bgm.src) {
          alert('当前没有加载音乐文件。请点击“上传音乐”并选择本地 mp3，或者将 HTML 中的音频链接替换为你的 mp3 文件。');
        } else {
          // user gesture required
          try{ await bgm.play(); hasStarted = true; playBtn.textContent = '⏸ 暂停音乐'; }catch(e2){ alert('浏览器阻止自动播放，请点击页面空白处或允许声音。'); }
        }
      }
    } else {
      if(bgm.paused){ bgm.play(); playBtn.textContent = '⏸ 暂停音乐'; }
      else { bgm.pause(); playBtn.textContent = '▶ 播放背景音乐'; }
    }
  });

  // 上传本地音乐文件
  audioFileInput.addEventListener('change', (ev) => {
    const f = ev.target.files[0];
    if(!f) return;
    const url = URL.createObjectURL(f);
    bgm.src = url;
    bgm.load();
    bgm.play();
    hasStarted = true;
    playBtn.textContent = '⏸ 暂停音乐';
  });

  // 点击任意处启用声音（解决部分浏览器限制）
  document.body.addEventListener('click', () => {
    if (!hasStarted && bgm.src) {
      bgm.play().then(()=>{ hasStarted=true; playBtn.textContent='⏸ 暂停音乐'; }).catch(()=>{/*ignore*/});
    }
  }, { once: true });

  // 心心效果
  heartBtn.addEventListener('click', () => {
    for(let i=0;i<8;i++){
      const el = document.createElement('div');
      el.textContent = '❤';
      el.style.position='absolute';
      el.style.right=(18 + Math.random()*140)+'px';
      el.style.bottom='24px';
      el.style.fontSize=(18+Math.random()*20)+'px';
      el.style.opacity=1;
      el.style.transform='translateY(0) scale(1)';
      overlay.appendChild(el);
      const anim = el.animate([
        { transform: 'translateY(0) scale(1)', opacity:1 },
        { transform: 'translateY(-140px) scale(1.6)', opacity:0 }
      ], { duration: 1200 + Math.random()*800, easing:'cubic-bezier(.2,.9,.2,1)'});
      anim.onfinish = ()=> el.remove();
    }
  });

  // 简单“花瓣/庆祝”效果
  confettiBtn.addEventListener('click', () => {
    for(let i=0;i<24;i++){
      const p = document.createElement('div');
      p.textContent = '✦';
      p.style.position='absolute';
      p.style.left=(20 + Math.random()*760)+'px';
      p.style.top=(20 + Math.random()*360)+'px';
      p.style.fontSize=(12+Math.random()*28)+'px';
      p.style.opacity=1;
      overlay.appendChild(p);
      const a = p.animate([
        { transform:'translateY(0) rotate(0)', opacity:1 },
        { transform:'translateY(400px) rotate(360deg)', opacity:0 }
      ], { duration: 900 + Math.random()*1900, easing:'linear' });
      a.onfinish = ()=> p.remove();
    }
  });

  // 下载当前 HTML（生成 blob）
  downloadBtn.addEventListener('click', () => {
    const htmlContent = `<!doctype html>\n` + document.documentElement.outerHTML;
    const blob = new Blob([htmlContent], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'welcome_yuange.html';
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  });

  hostGuide.addEventListener('click', () => {
    alert('快速部署到 GitHub Pages:\n1. 在 GitHub 新建一个仓库 (例如 welcome-yuange)\n2. 上传 welcome_yuange.html 到仓库根目录\n3. 到 Settings → Pages，将 branch 设为 main / root，保存\n4. 数分钟后，你的页面将在 https://<your-username>.github.io/<repo-name>/welcome_yuange.html 可访问\n\n也可以用 Netlify / Vercel 部署单文件页面。需要我帮你把文件打包成 ZIP 吗？');
  });

  // 切换欢迎文案示例
  toggleTextBtn.addEventListener('click', () => {
    const el = document.getElementById('welcomeText');
    if(el.textContent.includes('欢迎')) el.textContent = '圆哥，欢迎回家！';
    else el.textContent = '欢迎 圆哥！';
  });

  // small accessibility: allow replacing girl image by drag & drop onto card
  card.addEventListener('dragover', (e)=>{ e.preventDefault(); card.style.outline='2px dashed rgba(255,79,139,0.2)'; });
  card.addEventListener('dragleave', ()=>{ card.style.outline='none'; });
  card.addEventListener('drop', (e)=>{ e.preventDefault(); card.style.outline='none'; const f = e.dataTransfer.files && e.dataTransfer.files[0]; if(f && f.type.startsWith('image/')){ girl.src = URL.createObjectURL(f); } });

</script>
</body>
</html>
